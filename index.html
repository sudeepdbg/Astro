<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nadi Jyotish | Ancient Divine Secrets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #000; }
        .heading-font { font-family: 'Cinzel', serif; }
        .gold-glow { box-shadow: 0 0 20px rgba(217, 119, 6, 0.3); }
        .glass { background: rgba(20, 20, 20, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(217, 119, 6, 0.2); }
        
        /* Divine Background Overlay */
        .divine-bg {
            background-image: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.85)), url('https://images.unsplash.com/photo-1623150531024-e200f38b25dd?auto=format&fit=crop&q=80&w=1920');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
    </style>
</head>
<body class="divine-bg text-gray-200 min-h-screen">

    <div class="max-w-3xl mx-auto p-6">
        <header class="text-center py-12">
            <h1 class="heading-font text-5xl md:text-6xl text-amber-500 mb-2 tracking-widest uppercase">Nadi Jyotish</h1>
            <p class="text-amber-200/60 italic tracking-widest text-sm uppercase">Discover Your Destiny Written Centuries Ago</p>
            <div class="w-32 h-1 bg-amber-600 mx-auto mt-4 rounded-full opacity-50"></div>
        </header>

        <div class="glass gold-glow rounded-2xl p-8 mb-10 fade-in">
            <form id="nadiForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-amber-500 font-bold mb-2">Seeker's Name</label>
                        <input type="text" id="name" required placeholder="Enter full name" 
                            class="w-full bg-black/50 border border-amber-900/50 rounded-lg px-4 py-3 text-white focus:border-amber-500 outline-none transition">
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-amber-500 font-bold mb-2">Output Language</label>
                        <select id="language" class="w-full bg-black/50 border border-amber-900/50 rounded-lg px-4 py-3 text-white focus:border-amber-500 outline-none transition">
                            <option value="English">English</option>
                            <option value="Hindi">हिन्दी (Hindi)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-amber-500 font-bold mb-2">Birth Date</label>
                        <input type="date" id="date" required 
                            class="w-full bg-black/50 border border-amber-900/50 rounded-lg px-4 py-3 text-white focus:border-amber-500 outline-none transition">
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-amber-500 font-bold mb-2">Birth Time</label>
                        <input type="time" id="time" required 
                            class="w-full bg-black/50 border border-amber-900/50 rounded-lg px-4 py-3 text-white focus:border-amber-500 outline-none transition">
                    </div>
                </div>

                <div>
                    <label class="block text-xs uppercase tracking-widest text-amber-500 font-bold mb-2">Birth Location</label>
                    <input type="text" id="location" required placeholder="City, State, Country" 
                        class="w-full bg-black/50 border border-amber-900/50 rounded-lg px-4 py-3 text-white focus:border-amber-500 outline-none transition">
                </div>

                <button type="submit" id="submitBtn" 
                    class="w-full bg-gradient-to-r from-amber-700 via-amber-600 to-amber-700 text-black font-bold py-4 rounded-lg uppercase tracking-widest hover:from-amber-500 hover:to-amber-500 transition duration-300 shadow-xl">
                    ✨ Reveal Ancient Prediction
                </button>
            </form>
        </div>

        <div id="predictionResult" class="hidden glass rounded-2xl p-8 mb-10 border-amber-500/40 relative overflow-hidden">
            <div class="absolute top-0 right-0 p-4 opacity-10">
                <img src="https://cdn-icons-png.flaticon.com/512/2361/2361730.png" class="w-24" alt="Sacred Ohm">
            </div>
            
            <h2 class="heading-font text-3xl text-amber-500 mb-6 border-b border-amber-900 pb-2">Your Nadi Prediction</h2>
            
            <div id="predictionText" class="text-gray-300 leading-relaxed text-lg space-y-4">
                </div>
            
            <div class="mt-8 grid grid-cols-2 gap-4 text-sm">
                <div class="bg-amber-900/20 p-3 rounded border border-amber-800/30">
                    <span class="block text-amber-600 font-bold uppercase text-xs">Moon Sign</span>
                    <span id="moonSign" class="text-amber-200">--</span>
                </div>
                <div class="bg-amber-900/20 p-3 rounded border border-amber-800/30">
                    <span class="block text-amber-600 font-bold uppercase text-xs">Nakshatra</span>
                    <span id="nakshatra" class="text-amber-200">--</span>
                </div>
            </div>
        </div>

        <div id="errorMsg" class="hidden bg-red-900/20 border border-red-500/50 text-red-200 p-4 rounded-lg text-center mb-6">
            Unable to connect to the celestial server. Please try again.
        </div>

        <footer class="text-center text-amber-700 text-xs tracking-widest py-8 uppercase">
            &copy; 2026 Nadi Astrology Hub • Divine Wisdom for the Modern Soul
        </footer>
    </div>

    <script>
        // UPDATE THIS TO YOUR RAILWAY APP URL
        const BACKEND_URL = "https://web-production-your-id.up.railway.app"; 

        document.getElementById('nadiForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            const resultDiv = document.getElementById('predictionResult');
            const errorDiv = document.getElementById('errorMsg');
            
            btn.disabled = true;
            btn.innerHTML = "Consulting Ancient Leaves...";
            resultDiv.classList.add('hidden');
            errorDiv.classList.add('hidden');

            const payload = {
                name: document.getElementById('name').value,
                date: document.getElementById('date').value,
                time: document.getElementById('time').value,
                location: document.getElementById('location').value,
                language: document.getElementById('language').value
            };

            try {
                const response = await fetch(`${BACKEND_URL}/predict`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error('Heavenly servers are busy.');

                const data = await response.json();
                
                // Inject Data
                document.getElementById('predictionText').innerHTML = data.prediction.replace(/\n/g, '<br>');
                document.getElementById('moonSign').textContent = data.moon_sign_hindi || data.moon_sign;
                
                // Fetch nakshatra from the first planetary position for the moon if available
                const moonData = data.planetary_positions.find(p => p.planet === 'Moon');
                document.getElementById('nakshatra').textContent = moonData ? (moonData.nakshatra_hindi || moonData.nakshatra) : 'N/A';
                
                resultDiv.classList.remove('hidden');
                resultDiv.scrollIntoView({ behavior: 'smooth' });

            } catch (err) {
                errorDiv.classList.remove('hidden');
            } finally {
                btn.disabled = false;
                btn.innerHTML = "✨ Reveal Ancient Prediction";
            }
        });
    </script>
</body>
</html>
